#include "../ps3emu/shader_dasm.h"
#include "../ps3emu/ShaderRewriter.h"
#include <catch.hpp>

using namespace ShaderRewriter;

TEST_CASE() {
    unsigned char instr[] = {
        0x06, 0x00, 0x02, 0x00, 0xc8, 0x01, 0x1c, 0x9d, 0x00, 0x02, 0x00, 0x00,
        0xc8, 0x00, 0x3f, 0xe1, 0xd7, 0x0a, 0x3c, 0xa3, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    FragmentInstr fi;
    fragment_dasm_instr(instr, fi);
    auto st = MakeStatement(fi);
    auto str = PrintStatement(st.get());
    REQUIRE( str == "r0.xy = (attr_WPOS * 0.02);" );
}